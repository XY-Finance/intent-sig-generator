
# ğŸ“Š å€å¡Šéˆä½¿ç”¨è€…åˆ†ææ©Ÿå™¨å­¸ç¿’å°ˆæ¡ˆç¸½è¦½ï¼ˆML Project Overviewï¼‰

æœ¬å°ˆæ¡ˆç›®éŒ„æä¾›ä¸€å¥—å®Œæ•´çš„å€å¡Šéˆä½¿ç”¨è€…è³‡æ–™åˆ†ææµç¨‹ï¼Œæ¶µè“‹å¤šéˆè³‡æ–™æ”¶é›†ã€ç‰¹å¾µå·¥ç¨‹ã€è‡ªå‹•åŒ–æ©Ÿå™¨å­¸ç¿’ï¼ˆAutoMLï¼‰åˆ†ç¾¤ï¼Œä»¥åŠçµæœè¦–è¦ºåŒ–ã€‚æ‰€æœ‰æ¨¡çµ„èˆ‡è¨­å®šçš†ç‚ºäº†éˆæ´»èª¿æ•´ã€å¯é‡ç¾ç ”ç©¶èˆ‡å¯è¡Œçš„æ¥­å‹™æ´å¯Ÿè€Œè¨­è¨ˆï¼Œç›®æ¨™æ˜¯æ·±å…¥ç†è§£ä½¿ç”¨è€…è¡Œç‚ºä¸¦é€²è¡Œæœ‰æ•ˆåˆ†ç¾¤ã€‚

![nansen_ml](nansen_ml.png)
---

## ğŸ“ è³‡æ–™å¤¾çµæ§‹èªªæ˜

- `ml/config/`  
  - è³‡æ–™æ”¶é›†ã€ç‰¹å¾µå·¥ç¨‹èˆ‡åˆ†ææµç¨‹è¨­å®šæª” 
- `ml/data/`  
  - `raw/`ï¼šåŸå§‹å€å¡Šéˆè³‡æ–™  
  - `processed/`ï¼šè™•ç†å¾Œçš„ç‰¹å¾µèˆ‡åˆ†æçµæœ  
  - `features/`ï¼šå»ºæ¨¡ç”¨çš„ç‰¹å¾µæª”æ¡ˆ  
  - `models/`ï¼šå„²å­˜çš„æ¨¡å‹èˆ‡é æ¸¬çµæœ
- `ml/src/preprocessing/`  
  - è³‡æ–™æ”¶é›†èˆ‡ç‰¹å¾µå·¥ç¨‹è…³æœ¬
- `ml/src/models/kmeans/`  
  - KMeans åˆ†ç¾¤æµç¨‹èˆ‡åˆ†æè…³æœ¬
- `ml/src/visualization/`  
  - ç”¨æ–¼çµæœè¦–è¦ºåŒ–çš„å·¥å…·

---

## ğŸ§¬ è³‡æ–™èˆ‡ç‰¹å¾µèªªæ˜

**åŸå§‹è³‡æ–™**ï¼ˆä½æ–¼ `ml/data/raw/`ï¼‰  
  - åŒ…å«å€å¡Šéˆäº¤æ˜“è¨˜éŒ„ã€äº‹ä»¶ç´€éŒ„ã€ä»£å¹£é¤˜é¡ç­‰

**è™•ç†å¾Œç‰¹å¾µ**ï¼ˆä½æ–¼ `ml/data/processed/`ï¼‰ï¼š
  - `assets_distribution.csv`ï¼šä½¿ç”¨è€…è³‡ç”¢åœ¨ä¸åŒéˆèˆ‡ä»£å¹£çš„åˆ†ä½ˆ  
  - `tx_behavior.csv`ï¼šä½¿ç”¨è€…äº¤æ˜“è¡Œç‚ºç‰¹å¾µ  
  - `raw_user_features.csv`ï¼šæœªç¶“æ¸…ç†æˆ–å½™æ•´çš„åŸå§‹ç‰¹å¾µè³‡æ–™ï¼Œè«‹åƒè€ƒæ­¤ [google sheet](https://docs.google.com/spreadsheets/d/19LlNmWYfyDzuZncPNWM_FUSxIjMAJ7ZbU2_jGUsIkd4/edit?gid=535598059#gid=535598059)
  - `user_features.csv`ï¼šæœ€çµ‚æ•´åˆå¾Œã€ç”¨æ–¼å»ºæ¨¡èˆ‡åˆ†ç¾¤çš„ç‰¹å¾µæª”æ¡ˆ

**é‡è¦ç‰¹å¾µåŒ…å«ï¼š**

- `whale_score`ï¼šå·¨é¯¨è­˜åˆ¥ç”¨çš„ç¶œåˆè³‡ç”¢èˆ‡æµå‹•æ€§æŒ‡æ¨™  
- `active_score`ï¼šè¡¡é‡ä½¿ç”¨è€…æ´»èºåº¦çš„æŒ‡æ¨™  
- `*_balance_usd`ï¼šä»£å¹£é¤˜é¡ï¼ˆç¾å…ƒè¨ˆï¼‰  
- `*_ratio`ï¼šè³‡ç”¢çµ„åˆæ¯”ä¾‹  
- `avg_tx_usd_value_inflow/outflow`ï¼šå¹³å‡å–®ç­†æµå…¥/æµå‡ºé‡‘é¡  
- `total_tx_usd_value_inflow/outflow`ï¼šç¸½æµå…¥/æµå‡ºé‡‘é¡  
- `method_diversity`ï¼šåˆç´„äº’å‹•å¤šæ¨£æ€§ç†µå€¼  
- `chain_focus`, `protocol_type_focus`ï¼šéˆèˆ‡å”è­°é›†ä¸­ç¨‹åº¦æŒ‡æ•¸

> ğŸ”” **æ³¨æ„ï¼š** æ‰€æœ‰ç‰¹å¾µç‚ºå¤šéˆèšåˆçµæœï¼ˆEthereumã€Arbitrumã€Base ç­‰ï¼‰ï¼Œä¸¦éå–®éˆç‰¹å¾µã€‚

---

## ğŸš€ AutoML æµç¨‹å•Ÿå‹•æ­¥é©Ÿ

> æ­¥é©Ÿ 1 ~ 3 åƒ…éœ€åŸ·è¡Œä¸€æ¬¡ï¼Œå…¶é¤˜å¯ç¨ç«‹é‹è¡Œä»¥é‡è¤‡åˆ†æã€‚

1. **å®‰è£ç’°å¢ƒ**
   ```bash
   make venv
   ```

2. **å•Ÿå‹•ç’°å¢ƒ** (è‹¥é—œé–‰terminalå‰‡éœ€è¦å†æ¬¡è¼¸å…¥æŒ‡ä»¤å•Ÿå‹•ç’°å¢ƒ)
   ```bash
   source .venv/bin/activate
   ```

3. **åŸ·è¡Œå®Œæ•´ AutoML æµç¨‹**
   ```bash
   make automl
   ```

4. **æ”¶é›†åŸå§‹è³‡æ–™**
   ```bash
   make collect_raw_data
   ```

5. **åŸ·è¡Œç‰¹å¾µå·¥ç¨‹**
   ```bash
   make feature_engineering
   ```

6. **åŸ·è¡Œ KMeans åˆ†ç¾¤**
   ```bash
   make kmeans_pipeline
   ```

7. **æŸ¥çœ‹åˆ†æçµæœ**
   - ç‰¹å¾µæª”æ¡ˆï¼š`ml/data/processed/`
   - åˆ†ç¾¤çµæœï¼š`ml/src/results/<timestamp>/`

8. **æ›´æ–°ä»£å¹£åƒ¹æ ¼**ï¼ˆéœ€åœ¨æ”¶é›†è³‡æ–™å‰åŸ·è¡Œï¼‰
   ```bash
   make update_price
   ```

---

## ğŸ› ï¸ Config è¨­å®šå¦‚ä½•é‹ä½œï¼Ÿ

æ‰€æœ‰è³‡æ–™æ”¶é›†èˆ‡ç‰¹å¾µå·¥ç¨‹çš„åƒæ•¸çš†é€é `ml/config/training_configs.py` è¨­å®šæª”é€²è¡Œç®¡ç†ã€‚  
ä½ å¯ä»¥è‡ªè¨‚é€™äº› config ä¾†æ§åˆ¶è³‡æ–™æ”¶é›†ã€ç‰¹å¾µå·¥ç¨‹èˆ‡æ¨¡å‹è¡Œç‚ºï¼Œè€Œç„¡éœ€ä¿®æ”¹ç¨‹å¼ç¢¼ã€‚

### COLLECT_RAW_DATA_CONFIG

| åƒæ•¸ | èªªæ˜ |
|------|------|
| based_chain_id | ä¸»éˆ IDï¼ˆä¾‹å¦‚ Ethereum ç‚º 1ï¼‰ |
| chain_ids | æ¬²åˆ†æçš„éˆ ID åˆ—è¡¨ |
| timestamp_threshold | æœ€æ—©æ”¶é›†çš„è³‡æ–™æ™‚é–“æˆ³ |
| based_protocol_type | å”è­°é¡å‹ï¼Œå¦‚ 'Lending' |
| senders_count_threshold | è¦æŠ½æ¨£çš„ä½¿ç”¨è€…æ•¸é‡ |
| senders_max_pages / logs_max_pages | API æŠ“å–é æ•¸ä¸Šé™ |
| max_workers | ä¸¦è¡ŒæŠ“å–çš„åŸ·è¡Œç·’æ•¸é‡ |
| use_cache | æ˜¯å¦ä½¿ç”¨å¿«å–è³‡æ–™ |

### FEATURES_ENGINEERING_CONFIG

| åƒæ•¸ | èªªæ˜ |
|-----------------------|------|
| features | æœ€çµ‚è¼¸å‡ºè¦åŒ…å«çš„ç‰¹å¾µæ¬„ä½åˆ—è¡¨ï¼ˆå¦‚ whale_score, active_score ç­‰ï¼‰ |
| active_days_threshold | æ´»èºå¤©æ•¸çš„è¨ˆç®—é–€æª»ï¼ˆé è¨­ 730ï¼‰ |
| assets_lookback_months| è³‡ç”¢åˆ†å¸ƒå›æº¯çš„æœˆä»½æ•¸ï¼ˆé è¨­ 12ï¼‰ |
| whale_score_settings | whale_score æ¬Šé‡è¨­å®šï¼ˆdictï¼ŒæŒ‡å®šå„ç‰¹å¾µçš„åŠ æ¬Šï¼‰ |
| active_score_settings | active_score æ¬Šé‡è¨­å®šï¼ˆdictï¼ŒæŒ‡å®šå„ç‰¹å¾µçš„åŠ æ¬Šï¼‰ |

### KMEANS_PIPELINE_CONFIG

| åƒæ•¸ | èªªæ˜ |
|----------------|------|
| n_components | PCA ä¸»æˆåˆ†æ•¸é‡ï¼Œfloat ä»£è¡¨ä¿ç•™å¤šå°‘è®Šç•°é‡ï¼ˆå¦‚ 0.95ï¼‰ï¼Œint ä»£è¡¨å›ºå®šç¶­åº¦æ•¸ï¼ˆå¦‚ 5ï¼‰ |
| analyse | æ˜¯å¦åŸ·è¡Œåˆ†æèˆ‡è¦–è¦ºåŒ–æ­¥é©Ÿ |
| reduce_dimensions | æ˜¯å¦é€²è¡Œ PCA é™ç¶­ |
| optimization | æ˜¯å¦åŸ·è¡Œè¶…åƒæ•¸æœ€ä½³åŒ–ï¼ˆé€šå¸¸ production è¨­ç‚º Falseï¼‰ |

---

## âš ï¸ åˆ†ææµç¨‹æ³¨æ„äº‹é …

- **è¨­å®š Etherscan API Key**ï¼šè«‹åˆ° [Etherscan](https://etherscan.io/) ç”³è«‹è‡ªå·±çš„ API Keyï¼Œä¸¦è‡³ `ml/config/endpoints.py` å¡«å…¥ä½ çš„
- **è¨­å®š Configs**ï¼šæ‰€æœ‰é è¨­åƒæ•¸çš†é›†ä¸­æ–¼ `ml/config/` ä¸­ï¼Œè«‹è¨­å®šå€‹äººåŒ–åƒæ•¸ `ml/config/training_configs.py`
- **ç¢ºä¿è³‡æ–™æ›´æ–°**ï¼šè«‹æ¯æ—¥åŸ·è¡Œä¸€æ¬¡ `make update_price` ç¢ºä¿ä»£å¹£åƒ¹æ ¼å³æ™‚æ€§  
- **å¯é‡ç¾æ€§**ï¼šæ‰€æœ‰è¨­å®šã€åœ–è¡¨èˆ‡æ¨¡å‹çµæœçš†å„²å­˜æ–¼ `ml/src/results/`  
- **è³‡æºç®¡ç†**ï¼šåˆ†æå¤§é‡è³‡æ–™æ™‚ï¼Œå»ºè­°å…ˆä»¥å°æ¨£æœ¬æ¸¬è©¦åƒæ•¸ï¼ˆå¦‚è¨­å®š `senders_count_threshold = 30`ï¼‰

---

## ğŸ“ˆ åˆ†ç¾¤åˆ†æè©•ä¼°æŒ‡æ¨™

| æŒ‡æ¨™ | ç¯„åœ | å»ºè­°å€¼ | è§£é‡‹ |
|------|------|--------|------|
| Silhouette Score | -1 ~ 1 | > 0.5 | åˆ†ç¾¤å‡èšèˆ‡åˆ†é›¢æ€§ï¼Œæ„ˆé«˜æ„ˆå¥½ |
| Davies-Bouldin Index | 0 ~ âˆ | < 1 | ç¾¤é–“ç›¸ä¼¼åº¦ï¼Œæ„ˆä½æ„ˆä½³ |
| Calinski-Harabasz Index | 0 ~ âˆ | æ„ˆé«˜æ„ˆä½³ | ç¾¤é–“èˆ‡ç¾¤å…§è®Šç•°æ¯”å€¼ï¼Œæ„ˆé«˜æ„ˆå¥½ |

> è©•ä¼°åˆ†ç¾¤å“è³ªå¾Œï¼Œå¯ä½¿ç”¨å·¥å…·å¦‚ [Arkham](https://platform.arkhamintelligence.com/)ã€[Nansen](https://app.nansen.ai/) æ·±å…¥ç­è§£å€‹åˆ¥ä½¿ç”¨è€…è¡Œç‚ºèˆ‡èƒŒæ™¯ã€‚

---

## âœ… å»ºè­°èˆ‡å¸¸è¦‹éŒ¯èª¤

### âœ… ä½ æ‡‰è©²è¦ï¼š

1. **æ±ºå®šç›®æ¨™æ—ç¾¤èˆ‡è³‡æ–™ä¾†æºã€‚**  
   ç¢ºèªä½ è¦åˆ†æå“ªäº›ç”¨æˆ¶ç¾¤ï¼ˆå¦‚é¯¨é­šã€DeFi æ´»èºç”¨æˆ¶ï¼‰ï¼Œç¢ºä¿åŸå§‹è³‡æ–™æ¶µè“‹é€™äº›è¡Œç‚ºã€‚

2. **æ ¹æ“šé ˜åŸŸçŸ¥è­˜é¸æ“‡é—œéµç‰¹å¾µã€‚**  
   é‹ç”¨ä½ å°å€å¡Šéˆèˆ‡ç”¨æˆ¶è¡Œç‚ºçš„ç†è§£ï¼ŒæŒ‘é¸æœ‰æ„ç¾©çš„ç‰¹å¾µä½œç‚ºå»ºæ¨¡ä¾æ“šã€‚

3. **éœ€è¦æ–°ç‰¹å¾µæ™‚ä¸»å‹•æå‡ºã€‚**  
   è‹¥ç™¼ç¾ç›®å‰è³‡æ–™ç¼ºä¹é—œéµè¨Šè™Ÿï¼Œå¯è¯ç¹« Tanner å”åŠ©å°‡æ–°ç‰¹å¾µåŠ å…¥è³‡æ–™æµç¨‹ä¸­ã€‚

4. **æ³¨æ„ç‰¹å¾µå¤§å°èˆ‡å°ºåº¦ã€‚**  
   KMeans å°ç‰¹å¾µå°ºåº¦æ•æ„Ÿï¼Œæ‡‰çµ±ä¸€å°ºåº¦ï¼ˆå¦‚ normalization æˆ– standardizationï¼‰ä»¥é¿å…åå·®ã€‚

### âŒ ä½ ä¸æ‡‰è©²ï¼š

1. **é‡è¤‡åŸ·è¡Œ `make collect_raw_data`ã€‚**  
   è³‡æ–™æ”¶é›†éå¸¸è€—è²»æ™‚é–“ï¼Œé™¤éå¿…è¦ï¼Œé¿å…é »ç¹åŸ·è¡Œã€‚

2. **ä¸ç¶“ç¯©é¸å°±ä½¿ç”¨æ‰€æœ‰æ¬„ä½è¨“ç·´æ¨¡å‹ã€‚**  
   ç„¡æ„ç¾©æˆ–é«˜åº¦å…±ç·šæ€§çš„ç‰¹å¾µæœƒå½±éŸ¿æ¨¡å‹æ•ˆæœèˆ‡å¯è§£é‡‹æ€§ï¼Œå‹™å¿…å…ˆåšç‰¹å¾µé¸æ“‡ã€‚

3. **åªç”¨æ¥µå°‘é‡ç‰¹å¾µé€²è¡Œå»ºæ¨¡ã€‚**  
   ç‰¹å¾µå¤ªå°‘ï¼ˆå¦‚åƒ…ä½¿ç”¨ 2 é …ï¼‰æœƒå°è‡´æ¨¡å‹ç„¡æ³•æ•æ‰è¤‡é›œè¡Œç‚ºï¼Œåˆ†ç¾¤å“è³ªå·®ã€‚

4. **å¿½ç•¥æ¨¡å‹è©•ä¼°æŒ‡æ¨™ã€‚**  
   å‹™å¿…æŸ¥çœ‹ Silhouette åˆ†æ•¸ã€DB æŒ‡æ•¸èˆ‡ç¾¤é›†å¯è§£é‡‹æ€§ç­‰è©•ä¼°çµæœã€‚

---

## ğŸ’¡ Cursor åœ˜éšŠçš„å°ˆæ¥­å»ºè­°

- **ç‰¹å¾µå·¥ç¨‹å½±éŸ¿æœ€å¤§**ï¼šå¥½çš„ç‰¹å¾µå‹éè¤‡é›œçš„æ¨¡å‹  
- **è¨˜éŒ„åˆ†ææµç¨‹**ï¼šæœ‰åŠ©æ–¼é‡ç¾èˆ‡çŸ¥è­˜å‚³æ‰¿  
- **èˆ‡æ¥­å‹™é‚è¼¯æ¯”å°çµæœ**ï¼šç¢ºä¿æ•¸æ“šè§£é‡‹åˆç†æ€§  
- **é©åº¦ä½¿ç”¨ AutoMLï¼Œè‡ªè¡Œå¯©è¦–çµæœ**  
- **èˆ‡é–‹ç™¼å”ä½œï¼Œæ¸…æ¥šæå‡ºè³‡æ–™éœ€æ±‚**  
- **å®šæœŸæª¢æŸ¥æ¨¡å‹èˆ‡ç‰¹å¾µçš„é©ç”¨æ€§**ï¼ˆé˜²æ­¢è³‡æ–™æ¼‚ç§»ï¼‰

---

> ğŸ’¬ **è«‹è¨˜ä½ï¼š**  
> æœ€å¥½çš„è³‡æ–™åˆ†æä¸åªæ˜¯æŠ€è¡“åŸ·è¡Œï¼Œè€Œæ˜¯æå‡ºæ­£ç¢ºå•é¡Œã€é¸å°è³‡æ–™ï¼Œä¸¦åœ¨æƒ…å¢ƒä¸­æ‰¹åˆ¤æ€§åœ°è§£è®€çµæœã€‚
